<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>CoolDwarf.EOS.invert package &#8212; CoolDwarf  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=12dfc556" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="CoolDwarf.err package" href="CoolDwarf.err.html" />
    <link rel="prev" title="CoolDwarf.EOS.ChabrierDebras2021 package" href="CoolDwarf.EOS.ChabrierDebras2021.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="cooldwarf-eos-invert-package">
<h1>CoolDwarf.EOS.invert package<a class="headerlink" href="#cooldwarf-eos-invert-package" title="Link to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-CoolDwarf.EOS.invert.EOSInverter">
<span id="cooldwarf-eos-invert-eosinverter-module"></span><h2>CoolDwarf.EOS.invert.EOSInverter module<a class="headerlink" href="#module-CoolDwarf.EOS.invert.EOSInverter" title="Link to this heading">¶</a></h2>
<p>EOSInverter.py – Inverter class for EOS tables</p>
<p>This module contains the Inverter class for EOS tables. The class is designed to be used with the CoolDwarf Stellar Structure code, and provides the necessary functions to invert the EOS tables.
Because the inversion problem is non-linear, the Inverter class uses the scipy.optimize.minimize function to find the solution.</p>
<p>Further, because EOSs may not be truley invertible, the Inverter class uses a loss function to find the closest solution to the target energy.
over a limited range of temperatures and densities. This is intended to be a range centered around the initial guess for the inversion and
limited in size by some expected maximum deviation from the initial guess.</p>
<section id="dependencies">
<h3>Dependencies<a class="headerlink" href="#dependencies" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>cupy</p></li>
<li><p>torch</p></li>
<li><p>CoolDwarf.err</p></li>
</ul>
</section>
<section id="example-usage">
<h3>Example usage<a class="headerlink" href="#example-usage" title="Link to this heading">¶</a></h3>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">CoolDwarf.EOS.invert.EOSInverter</span> <span class="kn">import</span> <span class="n">Inverter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">CoolDwarf.EOS.ChabrierDebras2021.EOS</span> <span class="kn">import</span> <span class="n">CH21EOS</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eos</span> <span class="o">=</span> <span class="n">CH21EOS</span><span class="p">(</span><span class="s2">&quot;path/to/eos/table&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inverter</span> <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">eos</span><span class="p">,</span> <span class="n">TRange</span><span class="p">,</span> <span class="n">RhoRange</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logTInit</span><span class="p">,</span> <span class="n">logRhoInit</span> <span class="o">=</span> <span class="mf">7.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newTRange</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newRhoRange</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">energy</span> <span class="o">=</span> <span class="mf">1e15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newBounds</span> <span class="o">=</span> <span class="p">(</span><span class="n">newTRange</span><span class="p">,</span> <span class="n">newRhoRange</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inverter</span><span class="o">.</span><span class="n">set_bounds</span><span class="p">(</span><span class="n">newBounds</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logT</span><span class="p">,</span> <span class="n">logRho</span> <span class="o">=</span> <span class="n">inverter</span><span class="o">.</span><span class="n">temperature_density</span><span class="p">(</span><span class="n">energy</span><span class="p">,</span> <span class="n">logTInit</span><span class="p">,</span> <span class="n">logRhoInit</span><span class="p">)</span>
</pre></div>
</div>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="CoolDwarf.EOS.invert.EOSInverter.Inverter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">CoolDwarf.EOS.invert.EOSInverter.</span></span><span class="sig-name descname"><span class="pre">Inverter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">EOS</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CoolDwarf.EOS.invert.EOSInverter.Inverter" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Inverter – Inverter class for EOS tables</p>
<p>This class is designed to be used with the CoolDwarf Stellar Structure code, and provides the necessary functions
to invert the EOS tables. The Inverter class uses PyTorch optimizers to find the solution to the non-linear inversion problem.
Because EOSs may not be truly invertible, the Inverter class uses a loss function to find the closest solution to the target energy
over a limited range of temperatures and densities. This is intended to be a range centered around the initial guess for the inversion
and limited in size by some expected maximum deviation from the initial guess.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>EOS</strong><span class="classifier">EOS</span></dt><dd><p>EOS object to invert</p>
</dd>
<dt><strong>TRange</strong><span class="classifier">tuple</span></dt><dd><p>Tuple containing the minimum and maximum temperature (log10(T)) in the EOS table</p>
</dd>
<dt><strong>RhoRange</strong><span class="classifier">tuple</span></dt><dd><p>Tuple containing the minimum and maximum density (log10(ρ)) in the EOS table</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>EOS</strong><span class="classifier">EOS</span></dt><dd><p>EOS object to invert</p>
</dd>
<dt><strong>_TRange</strong><span class="classifier">tuple</span></dt><dd><p>Tuple containing the minimum and maximum temperature (log10(T)) in the EOS table</p>
</dd>
<dt><strong>_RhoRange</strong><span class="classifier">tuple</span></dt><dd><p>Tuple containing the minimum and maximum density (log10(ρ)) in the EOS table</p>
</dd>
<dt><strong>_bounds</strong><span class="classifier">tuple</span></dt><dd><p>Tuple containing the TRange and RhoRange</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>temperature_density(energy, logTInit, logRhoInit)</strong></p></td>
<td><p>Inverts the EOS to find the temperature and density that gives the target energy</p></td>
</tr>
<tr class="row-even"><td><p><strong>set_bounds(newBounds)</strong></p></td>
<td><p>Sets the bounds for the inversion</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="CoolDwarf.EOS.invert.EOSInverter.Inverter.set_bounds">
<span class="sig-name descname"><span class="pre">set_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tRange</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rRange</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CoolDwarf.EOS.invert.EOSInverter.Inverter.set_bounds" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CoolDwarf.EOS.invert.EOSInverter.Inverter.temperature_density">
<span class="sig-name descname"><span class="pre">temperature_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logTInit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logRhoInit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#CoolDwarf.EOS.invert.EOSInverter.Inverter.temperature_density" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CoolDwarf.EOS.invert.EOSInverter.cupy_to_torch">
<span class="sig-prename descclassname"><span class="pre">CoolDwarf.EOS.invert.EOSInverter.</span></span><span class="sig-name descname"><span class="pre">cupy_to_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cupy_array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CoolDwarf.EOS.invert.EOSInverter.cupy_to_torch" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-CoolDwarf.EOS.invert">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-CoolDwarf.EOS.invert" title="Link to this heading">¶</a></h2>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">CoolDwarf</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="CoolDwarf.html">CoolDwarf</a></li>
<li class="toctree-l1"><a class="reference internal" href="CoolDwarf.star.html">CoolDwarf.star</a></li>
<li class="toctree-l1"><a class="reference internal" href="CoolDwarf.EOS.html">CoolDwarf.EOS</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">CoolDwarf.EOS.invert</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-CoolDwarf.EOS.invert.EOSInverter">CoolDwarf.EOS.invert.EOSInverter module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-CoolDwarf.EOS.invert">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="CoolDwarf.model.html">CoolDwarf.model</a></li>
<li class="toctree-l1"><a class="reference internal" href="CoolDwarf.model.mesa.html">CoolDwarf.model.mesa</a></li>
<li class="toctree-l1"><a class="reference internal" href="CoolDwarf.opac.html">CoolDwarf.opac</a></li>
<li class="toctree-l1"><a class="reference internal" href="CoolDwarf.utils.misc.html">CoolDwarf.utils.misc</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="CoolDwarf.html">CoolDwarf package</a><ul>
  <li><a href="CoolDwarf.EOS.html">CoolDwarf.EOS package</a><ul>
      <li>Previous: <a href="CoolDwarf.EOS.ChabrierDebras2021.html" title="previous chapter">CoolDwarf.EOS.ChabrierDebras2021 package</a></li>
      <li>Next: <a href="CoolDwarf.err.html" title="next chapter">CoolDwarf.err package</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Emily M. Boudreaux.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/CoolDwarf.EOS.invert.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>